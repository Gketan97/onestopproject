<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>OneStopCareers - Job Board</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header>
    <h1>OneStopCareers</h1>
    <p>Your career struggle ends here</p>
  </header>

  <!-- Tabs -->
  <div class="tabs">
    <button id="jobs-tab" class="active">Jobs</button>
    <button id="referrals-tab">Referrals</button>
  </div>

  <!-- Desktop Filters -->
  <div class="filters-desktop">
    <input type="text" id="desktopSearchInput" placeholder="Search jobs..." />
    <select id="desktopLocationFilter">
      <option value="">All Locations</option>
      <option value="Remote">Remote</option>
      <option value="Onsite">Onsite</option>
    </select>
    <select id="desktopRoleFilter">
      <option value="">All Roles</option>
      <option value="Developer">Developer</option>
      <option value="Analyst">Analyst</option>
    </select>
    <button id="desktopResetFilters">Clear</button>
  </div>

  <!-- Mobile Filters -->
  <div class="filters-mobile">
    <button id="mobileFilterToggle">Filter</button>
  </div>

  <!-- Mobile Filter Screen -->
  <div id="mobileFilterScreen" class="mobile-filter-screen">
    <button id="closeFilterBtn">Close</button>
    <input type="text" id="mobileSearchInput" placeholder="Search jobs..." />
    <select id="mobileLocationFilter">
      <option value="">All Locations</option>
      <option value="Remote">Remote</option>
      <option value="Onsite">Onsite</option>
    </select>
    <select id="mobileRoleFilter">
      <option value="">All Roles</option>
      <option value="Developer">Developer</option>
      <option value="Analyst">Analyst</option>
    </select>
    <button id="applyFiltersBtn">Apply</button>
    <button id="clearFiltersBtn">Clear</button>
  </div>

  <!-- Job Listings -->
  <div id="jobs-container"></div>
  <button id="loadMoreBtn">Load More</button>

  <!-- Referrals Listings -->
  <div id="referrals-container" style="display:none;"></div>
  <button id="referralLoadMoreBtn" style="display:none;">Load More</button>

  <!-- Job Modal -->
  <div id="jobModal" class="modal">
    <div class="modal-content">
      <span class="close-btn" id="closeJobModal">&times;</span>
      <div id="jobModalBody"></div>
    </div>
  </div>

  <!-- Referral Modal -->
  <div id="referralModal" class="modal">
    <div class="modal-content">
      <span class="close-btn" id="closeReferralModal">&times;</span>
      <div id="referralModalBody"></div>
    </div>
  </div>

  <script>
    const JOBS_JSON_URL = 'jobs.json';
    const REFERRALS_JSON_URL = 'referrals.json';

    const state = {
      allJobs: [],
      allReferrals: [],
      filteredJobs: [],
      filteredReferrals: [],
      currentPage: 1,
      currentReferralPage: 1,
      itemsPerPage: 10,
      ui: { isFilterScreenOpen: false }
    };

    const jobsContainer = document.getElementById('jobs-container');
    const referralsContainer = document.getElementById('referrals-container');
    const loadMoreBtn = document.getElementById('loadMoreBtn');
    const referralLoadMoreBtn = document.getElementById('referralLoadMoreBtn');

    const desktopSearchInput = document.getElementById('desktopSearchInput');
    const desktopLocationFilter = document.getElementById('desktopLocationFilter');
    const desktopRoleFilter = document.getElementById('desktopRoleFilter');
    const desktopResetFilters = document.getElementById('desktopResetFilters');

    const mobileFilterToggle = document.getElementById('mobileFilterToggle');
    const mobileFilterScreen = document.getElementById('mobileFilterScreen');
    const closeFilterBtn = document.getElementById('closeFilterBtn');
    const mobileSearchInput = document.getElementById('mobileSearchInput');
    const mobileLocationFilter = document.getElementById('mobileLocationFilter');
    const mobileRoleFilter = document.getElementById('mobileRoleFilter');
    const applyFiltersBtn = document.getElementById('applyFiltersBtn');
    const clearFiltersBtn = document.getElementById('clearFiltersBtn');

    const jobsTab = document.getElementById('jobs-tab');
    const referralsTab = document.getElementById('referrals-tab');

    const jobModal = document.getElementById('jobModal');
    const jobModalBody = document.getElementById('jobModalBody');
    const closeJobModal = document.getElementById('closeJobModal');

    const referralModal = document.getElementById('referralModal');
    const referralModalBody = document.getElementById('referralModalBody');
    const closeReferralModal = document.getElementById('closeReferralModal');

    function applyFilters() {
      const search = (desktopSearchInput.value || mobileSearchInput.value).toLowerCase();
      const location = desktopLocationFilter.value || mobileLocationFilter.value;
      const role = desktopRoleFilter.value || mobileRoleFilter.value;

      state.filteredJobs = state.allJobs.filter(job => {
        return (!search || job.title.toLowerCase().includes(search)) &&
               (!location || job.location === location) &&
               (!role || job.role === role);
      });

      state.currentPage = 1;
      renderJobs();
    }

    function clearFilters() {
      desktopSearchInput.value = '';
      desktopLocationFilter.value = '';
      desktopRoleFilter.value = '';
      mobileSearchInput.value = '';
      mobileLocationFilter.value = '';
      mobileRoleFilter.value = '';
      applyFilters();
    }

    function renderJobs() {
      jobsContainer.innerHTML = '';
      const start = 0;
      const end = state.currentPage * state.itemsPerPage;
      const jobsToShow = state.filteredJobs.slice(start, end);

      jobsToShow.forEach(job => {
        const div = document.createElement('div');
        div.classList.add('job-card');
        div.innerHTML = `<h3>${job.title}</h3><p>${job.location} | ${job.role}</p>`;
        div.addEventListener('click', () => {
          jobModalBody.innerHTML = `<h2>${job.title}</h2><p>${job.description}</p>`;
          jobModal.style.display = 'block';
        });
        jobsContainer.appendChild(div);
      });

      loadMoreBtn.style.display = state.filteredJobs.length > end ? 'block' : 'none';
    }

    function renderReferrals() {
      referralsContainer.innerHTML = '';
      const start = 0;
      const end = state.currentReferralPage * state.itemsPerPage;
      const refsToShow = state.allReferrals.slice(start, end);

      refsToShow.forEach(ref => {
        const div = document.createElement('div');
        div.classList.add('referral-card');
        div.innerHTML = `<h3>${ref.company}</h3><p>${ref.position}</p>`;
        div.addEventListener('click', () => {
          referralModalBody.innerHTML = `<h2>${ref.company}</h2><p>${ref.details}</p>`;
          referralModal.style.display = 'block';
        });
        referralsContainer.appendChild(div);
      });

      referralLoadMoreBtn.style.display = state.allReferrals.length > end ? 'block' : 'none';
    }

    function openFilterScreen() {
      mobileFilterScreen.style.transform = "translateX(0)";
      state.ui.isFilterScreenOpen = true;
    }

    function closeFilterScreen() {
      mobileFilterScreen.style.transform = "translateX(100%)";
      state.ui.isFilterScreenOpen = false;
    }

    // Event Listeners
    mobileFilterToggle.addEventListener('click', openFilterScreen);
    closeFilterBtn.addEventListener('click', closeFilterScreen);
    applyFiltersBtn.addEventListener('click', () => { applyFilters(); closeFilterScreen(); });
    clearFiltersBtn.addEventListener('click', clearFilters);

    desktopSearchInput.addEventListener('input', applyFilters);
    desktopLocationFilter.addEventListener('change', applyFilters);
    desktopRoleFilter.addEventListener('change', applyFilters);
    desktopResetFilters.addEventListener('click', clearFilters);

    loadMoreBtn.addEventListener('click', () => { state.currentPage++; renderJobs(); });
    referralLoadMoreBtn.addEventListener('click', () => { state.currentReferralPage++; renderReferrals(); });

    closeJobModal.addEventListener('click', () => jobModal.style.display = 'none');
    closeReferralModal.addEventListener('click', () => referralModal.style.display = 'none');

    jobsTab.addEventListener('click', () => {
      jobsTab.classList.add('active');
      referralsTab.classList.remove('active');
      jobsContainer.style.display = 'block';
      referralsContainer.style.display = 'none';
      loadMoreBtn.style.display = 'block';
      referralLoadMoreBtn.style.display = 'none';
    });

    referralsTab.addEventListener('click', () => {
      referralsTab.classList.add('active');
      jobsTab.classList.remove('active');
      jobsContainer.style.display = 'none';
      referralsContainer.style.display = 'block';
      loadMoreBtn.style.display = 'none';
      referralLoadMoreBtn.style.display = 'block';
    });

    // Init load
    Promise.all([
      fetch(JOBS_JSON_URL).then(res => res.json()),
      fetch(REFERRALS_JSON_URL).then(res => res.json())
    ]).then(([jobs, referrals]) => {
      state.allJobs = jobs;
      state.allReferrals = referrals;
      applyFilters();
    });
  </script>
</body>
</html>
